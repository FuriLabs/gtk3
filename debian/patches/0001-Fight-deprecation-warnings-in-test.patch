From c4e533ecd6659a26a2a05d49d6f2941007b4217d Mon Sep 17 00:00:00 2001
From: Matthias Clasen <mclasen@redhat.com>
Date: Sat, 28 Jun 2014 00:41:26 -0400
Subject: [PATCH] Fight deprecation warnings in test

This time, in installed tests.
---
 testsuite/a11y/a11ychildren.test.in | 2 +-
 testsuite/a11y/a11yderive.test.in   | 2 +-
 testsuite/a11y/a11ytests.test.in    | 2 +-
 testsuite/a11y/a11ytext.test.in     | 2 +-
 testsuite/a11y/a11ytree.test.in     | 2 +-
 testsuite/a11y/a11yutil.test.in     | 2 +-
 testsuite/a11y/a11yvalue.test.in    | 2 +-
 testsuite/gtk/Makefile.am           | 2 +-
 8 files changed, 8 insertions(+), 8 deletions(-)

Index: b/testsuite/a11y/a11ychildren.test.in
===================================================================
--- a/testsuite/a11y/a11ychildren.test.in
+++ b/testsuite/a11y/a11ychildren.test.in
@@ -1,4 +1,4 @@
 [Test]
-Exec=/bin/sh -c "@pkglibexecdir@/installed-tests/children"
+Exec=/bin/sh -c "env G_ENABLE_DIAGNOSTIC=0 @pkglibexecdir@/installed-tests/children"
 Type=session
 
Index: b/testsuite/a11y/a11yderive.test.in
===================================================================
--- a/testsuite/a11y/a11yderive.test.in
+++ b/testsuite/a11y/a11yderive.test.in
@@ -1,4 +1,4 @@
 [Test]
-Exec=/bin/sh -c "@pkglibexecdir@/installed-tests/derive"
+Exec=/bin/sh -c "env G_ENABLE_DIAGNOSTIC=0 @pkglibexecdir@/installed-tests/derive"
 Type=session
 
Index: b/testsuite/a11y/a11ytests.test.in
===================================================================
--- a/testsuite/a11y/a11ytests.test.in
+++ b/testsuite/a11y/a11ytests.test.in
@@ -1,4 +1,4 @@
 [Test]
-Exec=/bin/sh -c "@pkglibexecdir@/installed-tests/accessibility-dump -k --verbose --directory @pkglibexecdir@/installed-tests/a11ytests"
+Exec=/bin/sh -c "env G_ENABLE_DIAGNOSTIC=0 @pkglibexecdir@/installed-tests/accessibility-dump -k --verbose --directory @pkglibexecdir@/installed-tests/a11ytests"
 Type=session
 
Index: b/testsuite/a11y/a11ytext.test.in
===================================================================
--- a/testsuite/a11y/a11ytext.test.in
+++ b/testsuite/a11y/a11ytext.test.in
@@ -1,4 +1,4 @@
 [Test]
-Exec=/bin/sh -c "@pkglibexecdir@/installed-tests/text"
+Exec=/bin/sh -c "env G_ENABLE_DIAGNOSTIC=0 @pkglibexecdir@/installed-tests/text"
 Type=session
 
Index: b/testsuite/a11y/a11ytree.test.in
===================================================================
--- a/testsuite/a11y/a11ytree.test.in
+++ b/testsuite/a11y/a11ytree.test.in
@@ -1,4 +1,4 @@
 [Test]
-Exec=/bin/sh -c "@pkglibexecdir@/installed-tests/tree-relationships"
+Exec=/bin/sh -c "env G_ENABLE_DIAGNOSTIC=0 @pkglibexecdir@/installed-tests/tree-relationships"
 Type=session
 
Index: b/testsuite/a11y/a11yutil.test.in
===================================================================
--- a/testsuite/a11y/a11yutil.test.in
+++ b/testsuite/a11y/a11yutil.test.in
@@ -1,4 +1,4 @@
 [Test]
-Exec=/bin/sh -c "@pkglibexecdir@/installed-tests/util"
+Exec=/bin/sh -c "env G_ENABLE_DIAGNOSTIC=0 @pkglibexecdir@/installed-tests/util"
 Type=session
 
Index: b/testsuite/a11y/a11yvalue.test.in
===================================================================
--- a/testsuite/a11y/a11yvalue.test.in
+++ b/testsuite/a11y/a11yvalue.test.in
@@ -1,4 +1,4 @@
 [Test]
-Exec=/bin/sh -c "@pkglibexecdir@/installed-tests/value"
+Exec=/bin/sh -c "env G_ENABLE_DIAGNOSTIC=0 @pkglibexecdir@/installed-tests/value"
 Type=session
 
Index: b/testsuite/gtk/Makefile.am
===================================================================
--- a/testsuite/gtk/Makefile.am
+++ b/testsuite/gtk/Makefile.am
@@ -155,7 +155,7 @@
 %.test: %$(EXEEXT) Makefile
 	$(AM_V_GEN) (echo '[Test]' > $@.tmp; \
 	echo 'Type=session' >> $@.tmp; \
-	echo 'Exec=$(insttestdir)/$<' >> $@.tmp; \
+	echo 'Exec=env G_ENABLE_DIAGNOSTIC=0 $(insttestdir)/$<' >> $@.tmp; \
 	mv $@.tmp $@)
 
 test_files = $(TEST_PROGS:=.test)
